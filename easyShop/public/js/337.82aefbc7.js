"use strict";(self["webpackChunkeasyshop_h5"]=self["webpackChunkeasyshop_h5"]||[]).push([[337],{3337:function(e,t,o){o.r(t),o.d(t,{default:function(){return b}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"loginContext"},[t("van-nav-bar",{attrs:{title:"登录","left-arrow":""},on:{"click-left":function(t){return e.$router.go(-1)}}}),t("div",{staticClass:"check"},[t("van-radio-group",{attrs:{direction:"horizontal"},on:{change:e.checkChange},model:{value:e.isLogin,callback:function(t){e.isLogin=t},expression:"isLogin"}},[t("van-radio",{attrs:{name:"1",shape:"square"}},[e._v("账号密码登录")]),t("van-radio",{attrs:{name:"2",shape:"square"}},[e._v("手机号码登录")])],1)],1),t("div",{staticClass:"Login"},["1"===e.isLogin?t("van-form",{on:{submit:e.onSubmit}},[t("van-field",{attrs:{name:"account",label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请填写用户名"},{required:!0,validator:e.name,message:"用户名长度在5-12之间"}]},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}}),"2"===e.numberAdd?t("van-field",{attrs:{name:"numPhoto",type:"number",label:"手机号码",placeholder:"请输入手机号码",rules:[{required:!0,message:"请填写手机号"},{required:!0,validator:e.photoNum,message:"请输入正确的手机号"}]},model:{value:e.numPhoto,callback:function(t){e.numPhoto=t},expression:"numPhoto"}}):e._e(),"2"===e.numberAdd?t("van-field",{attrs:{clearable:"",type:"number",name:"numCode",label:"短信验证码",placeholder:"请输入短信验证码",rules:[{required:!0,message:"请填写验证码"},{required:!0,validator:e.codeNum,message:"请输入正确的验证码"}]},scopedSlots:e._u([{key:"button",fn:function(){return[t("span",{on:{click:e.sendCode}},[e._v(e._s(0===e.time?"发送验证码":`${e.time}秒重新发送`))])]},proxy:!0}],null,!1,3497939142),model:{value:e.numCode,callback:function(t){e.numCode=t},expression:"numCode"}}):e._e(),t("van-field",{attrs:{type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"},{required:!0,validator:e.password1,message:"密码长度在6-12位之间"}]},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),t("div",{staticClass:"check"},[t("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.numberAdd,callback:function(t){e.numberAdd=t},expression:"numberAdd"}},[t("van-radio",{attrs:{name:"1"}},[e._v("登录")]),t("van-radio",{attrs:{name:"2"}},[e._v("注册")])],1)],1),t("div",{staticStyle:{margin:"16px"}},[t("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"}},[e._v(e._s("1"===e.numberAdd?"登录":"注册"))])],1)],1):t("van-form",{on:{submit:e.onSubmit}},[t("van-field",{attrs:{name:"photo",type:"number",label:"手机号码",placeholder:"请输入手机号码",rules:[{required:!0,message:"请填写手机号"},{required:!0,validator:e.photoNum,message:"请输入正确的手机号"}]},model:{value:e.photo,callback:function(t){e.photo=t},expression:"photo"}}),t("van-field",{attrs:{clearable:"",type:"number",name:"code",label:"短信验证码",placeholder:"请输入短信验证码",rules:[{required:!0,message:"请填写验证码"},{required:!0,validator:e.codeNum,message:"请输入正确的验证码"}]},scopedSlots:e._u(["2"===e.isLogin?{key:"button",fn:function(){return[t("span",{on:{click:e.sendCode}},[e._v(e._s(0===e.time?"发送验证码":`${e.time}秒重新发送`))])]},proxy:!0}:null],null,!0),model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),t("div",{staticClass:"check"},[t("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.photoAdd,callback:function(t){e.photoAdd=t},expression:"photoAdd"}},[t("van-radio",{attrs:{name:"1"}},[e._v("登录")]),t("van-radio",{attrs:{name:"2"}},[e._v("注册")])],1)],1),t("div",{staticStyle:{margin:"16px"}},[t("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"}},[e._v(e._s("1"===e.photoAdd?"登录":"注册"))])],1)],1)],1)],1)},a=[],r=(o(7658),o(435));const n=e=>(0,r.Z)("/login","post",{...e}),i=e=>(0,r.Z)("/register","post",{...e}),d=e=>(0,r.Z)("/register/code/check","get",{...e}),u=e=>(0,r.Z)("/login/code","post",{...e}),l=e=>(0,r.Z)("/code","get",{...e}),c=e=>(0,r.Z)("/login/code","get",{moblie:e});var m={name:"easy-Login",data(){return{account:"",password:"",numCode:"",numPhoto:"",photo:"",code:"",time:0,numberAdd:"1",photoAdd:"1",isLogin:"1"}},methods:{checkChange(){this.numberAdd="1",this.photoAdd="1"},codeNum(e){return/^[0-9]{6}$/.test(e)},photoNum(e){return/^1[3-9]\d{9}$/.test(e)},password1(e){return/[a-zA-Z0-9]{6,12}/.test(e)},name(e){return/[a-zA-Z0-9]{5,12}/.test(e)},async onSubmit(e){if("1"===this.isLogin)if("1"===this.numberAdd)try{const t=await n({account:e.account,password:e.password});this.$toast("登录成功"),this.$store.commit("user/setUserInfo",t.result),this.$router.push(`${this.$route.query.from}`)}catch(t){this.$toast(t.response.data.message)}else try{const t=await i({account:e.account,mobile:e.numPhoto,code:e.numCode,password:e.password,type:"app"});this.$toast("注册成功"),this.$store.commit("user/setUserInfo",t.result),this.$router.push(`${this.$route.query.from}`)}catch(t){this.$toast(t.response.data.message)}else if("1"===this.photoAdd){console.log("登录");try{const t=await u({mobile:e.photo,code:e.code});this.$store.commit("user/setUserInfo",t.result),this.$router.push(`${this.$route.query.from}`)}catch(t){this.$toast(t.response.data.message)}}else{console.log("注册");try{const t=await d({mobile:e.photo,code:e.code});this.$store.commit("user/setUserInfo",t.result),this.$router.push(`${this.$route.query.from}`)}catch(t){this.$toast(t.response.data.message)}}},async sendCode(){if(0===this.time){this.time=60;let t=null;if("1"===this.isLogin){if("2"===this.numberAdd)try{await l({mobile:this.numPhoto,type:"register"}),this.$toast("发送成功")}catch(e){this.$toast(e.response.data.message)}}else if("1"===this.photoAdd)try{const e=await c(this.photo);console.log(e)}catch(e){this.$toast(e.response.data.message)}else try{await l({mobile:this.photo,type:"register"}),this.$toast("发送成功")}catch(e){this.$toast(e.response.data.message)}t=setInterval((()=>{this.time--,0===this.time&&clearInterval(t)}),1e3)}else this.$toast(`请在${this.time}后重新发送`)}},created(){console.log(this.$route.query.from)}},h=m,p=o(1001),v=(0,p.Z)(h,s,a,!1,null,"1cf26561",null),b=v.exports}}]);
//# sourceMappingURL=337.82aefbc7.js.map
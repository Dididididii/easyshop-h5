{"version":3,"file":"js/721.60b63da6.js","mappings":"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","sources":["webpack://easyshop-h5/./src/views/cart/index.vue","webpack://easyshop-h5/src/views/cart/index.vue","webpack://easyshop-h5/./src/views/cart/index.vue?f4be","webpack://easyshop-h5/./src/views/cart/index.vue?d67d","webpack://easyshop-h5/./src/api/cart.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"cartContext\"},[_c('van-nav-bar',{attrs:{\"title\":\"购物车\",\"placeholder\":\"\",\"fixed\":\"\"}}),(_vm.cartList.length>0)?_c('div',{staticClass:\"goodsList\"},_vm._l((_vm.cartList),function(item){return _c('van-swipe-cell',{key:item.skuId,scopedSlots:_vm._u([{key:\"right\",fn:function(){return [_c('van-button',{staticClass:\"delete-button\",attrs:{\"square\":\"\",\"text\":\"删除\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.delCarts(item.skuId)}}})]},proxy:true}],null,true)},[_c('van-card',{staticClass:\"goods-card\",attrs:{\"num\":item.count,\"price\":item.price,\"title\":item.name,\"desc\":item.attrsText},scopedSlots:_vm._u([{key:\"thumb\",fn:function(){return [_c('div',{staticStyle:{\"display\":\"flex\"}},[_c('van-checkbox',{on:{\"change\":(e)=>_vm.onCheckChange(e,item.skuId,item.count)},model:{value:(item.selected),callback:function ($$v) {_vm.$set(item, \"selected\", $$v)},expression:\"item.selected\"}}),_c('van-image',{staticClass:\"cartImages\",staticStyle:{\"margin-left\":\"10px\"},attrs:{\"fit\":\"cover\",\"src\":item.picture},on:{\"click\":function($event){return _vm.$router.push(`/goods?id=${item.id}`)}}})],1)]},proxy:true},{key:\"num\",fn:function(){return [_c('van-stepper',{on:{\"change\":(e)=> _vm.onChange(e,item.skuId,item.selected)},model:{value:(item.count),callback:function ($$v) {_vm.$set(item, \"count\", $$v)},expression:\"item.count\"}})]},proxy:true}],null,true)})],1)}),1):(!_vm.noneToken)?_c('div',{staticClass:\"notGoodsList\"},[_c('van-empty',{staticClass:\"custom-image\",attrs:{\"image\":\"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.xabanjan.com%2Ftemplates%2Fshop%2F186%2Fimages%2Fnone.png&refer=http%3A%2F%2Fwww.xabanjan.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1668176201&t=ccadaa10333db2d786588bd14f2d1f45\",\"description\":\"去添加点什么吧\"}})],1):_vm._e(),(_vm.noneToken)?_c('div',{staticClass:\"notLogin\"},[_c('van-empty',{attrs:{\"image\":\"error\",\"description\":\"您还未登录\"}},[_c('van-button',{staticClass:\"bottom-button\",attrs:{\"round\":\"\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.$router.push(`/login?from=/cart`)}}},[_vm._v(\"去登陆\")])],1)],1):_vm._e(),(!_vm.noneToken)?_c('footer',[_c('van-submit-bar',{attrs:{\"price\":_vm.price,\"button-text\":\"提交订单\"},on:{\"submit\":_vm.onSubmit}},[_c('van-checkbox',{model:{value:(_vm.allCheck),callback:function ($$v) {_vm.allCheck=$$v},expression:\"allCheck\"}},[_vm._v(\"全选\")])],1)],1):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"cartContext\">\r\n    <van-nav-bar\r\n      title=\"购物车\"\r\n      placeholder \r\n      fixed\r\n    />\r\n    <!-- 正常的购物车 -->\r\n    <div class=\"goodsList\" v-if=\"cartList.length>0\" >\r\n      <van-swipe-cell v-for=\"item in cartList\" :key=\"item.skuId\">\r\n        <van-card\r\n          :num=\"item.count\"\r\n          :price=\"item.price\"\r\n          :title=\"item.name\"\r\n          :desc=\"item.attrsText\"\r\n          class=\"goods-card\"\r\n        >\r\n        <template #thumb >\r\n          <div style=\"display:flex;\">\r\n            <van-checkbox @change=\"(e)=>onCheckChange(e,item.skuId,item.count)\" v-model=\"item.selected\"></van-checkbox>\r\n            <van-image\r\n              @click=\"$router.push(`/goods?id=${item.id}`)\"\r\n              style=\"margin-left: 10px;\"\r\n              class=\"cartImages\"\r\n              fit=\"cover\"\r\n              :src=\"item.picture\"\r\n            />\r\n          </div>\r\n        </template>\r\n        <template #num >\r\n          <van-stepper v-model=\"item.count\" @change=\"(e)=> onChange(e,item.skuId,item.selected)\" />\r\n        </template>\r\n      </van-card>\r\n        <template #right>\r\n          <van-button @click=\"delCarts(item.skuId)\" square text=\"删除\" type=\"danger\" class=\"delete-button\" />\r\n        </template>\r\n      </van-swipe-cell>\r\n    </div>\r\n    <!-- 登录后购物车无商品 -->\r\n    <div class=\"notGoodsList\" v-else-if=\"!noneToken\">\r\n      <van-empty\r\n        class=\"custom-image\"\r\n        image=\"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.xabanjan.com%2Ftemplates%2Fshop%2F186%2Fimages%2Fnone.png&refer=http%3A%2F%2Fwww.xabanjan.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1668176201&t=ccadaa10333db2d786588bd14f2d1f45\"\r\n        description=\"去添加点什么吧\"\r\n      />\r\n    </div>\r\n    <!-- 未登录的购物车 -->\r\n    <div class=\"notLogin\" v-if=\"noneToken\">\r\n      <van-empty image=\"error\" description=\"您还未登录\">\r\n        <van-button round type=\"danger\" class=\"bottom-button\" @click=\"$router.push(`/login?from=/cart`)\">去登陆</van-button>\r\n      </van-empty>\r\n    </div>\r\n    <footer v-if=\"!noneToken\">\r\n      <van-submit-bar :price=\"price\" button-text=\"提交订单\" @submit=\"onSubmit\">\r\n        <van-checkbox v-model=\"allCheck\" >全选</van-checkbox>\r\n      </van-submit-bar>\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getCart,delCart,updatCart } from '@/api/cart'\r\nexport default {\r\n    name:'easy-cart',\r\n    data(){\r\n      return {\r\n        checked:false,\r\n        noneToken:false,\r\n        cartList:[],\r\n      }\r\n    },\r\n    methods:{\r\n      async onCheckChange(e,id,count) {\r\n        await updatCart({id,count,selected:e})\r\n      },\r\n      async onChange(e,id,selected){\r\n        // console.log(e,id);\r\n        await updatCart({id,count:e,selected})\r\n      },\r\n      onSubmit(){\r\n        let checkList = this.cartList.filter(item=>item.selected)\r\n        let goodsList = [],\r\n            map={}\r\n        // console.log(this.cartList.filter(item=>item.selected));\r\n        for(let i = 0; i<checkList.length;i++) {\r\n          let ai = checkList[i]\r\n          // console.log(ai);\r\n          if(!map[ai.id]){\r\n            goodsList.push(\r\n              {\r\n                id:ai.id,\r\n                name:ai.name,\r\n                specs: [\r\n                  {\r\n                    skuId:ai.skuId,\r\n                    price:(ai.price+0)*100,\r\n                    desc:ai.attrsText,\r\n                    count:ai.count,\r\n                    picture:ai.picture\r\n                  }\r\n                ]\r\n              }\r\n            )\r\n            map[ai.id] =ai\r\n          } else {\r\n            for(let j =0;j<goodsList.length;j++) {\r\n              let dj = goodsList[j]\r\n              if(dj.id === ai.id) {\r\n                dj.specs.push(\r\n                  {\r\n                    skuId:ai.skuId,\r\n                    price:(ai.price+0)*100,\r\n                    desc:ai.attrsText,\r\n                    count:ai.count,\r\n                    picture:ai.picture\r\n                  }\r\n                )\r\n                break\r\n              }\r\n            }\r\n          }\r\n        }\r\n        // console.log(goodsList);\r\n        // this.cartList.forEach(item=>{\r\n        //   if(item.selected) {\r\n        //     goodsList.push({\r\n        //       id:item.id,\r\n        //       name:item.name,\r\n        //       specs:[\r\n        //       {\r\n        //         skuId:item.skuId,\r\n        //         price:(item.price+0)*100,\r\n        //         desc:item.attrsText,\r\n        //         count:item.count,\r\n        //         picture:item.picture\r\n        //       }\r\n        //       ]\r\n        //     })\r\n        //   }\r\n        // })\r\n        this.$store.commit('goods/setGoodsList',goodsList)\r\n        this.$router.push('/place')\r\n      },\r\n      async getCartList() {\r\n        const res = await getCart()\r\n        this.cartList = res.result.valids\r\n      },\r\n      async delCarts(id) {\r\n        await delCart({ids:[`${id}`],clearAll:false,clearInvalid:false})\r\n        this.getCartList()\r\n      }\r\n    },\r\n    created(){\r\n      if(this.$store.state.user.profile.token) {\r\n        this.getCartList()\r\n      } else {\r\n        this.noneToken = true\r\n      }\r\n    },\r\n    computed:{\r\n      allCheck:{\r\n        get() {\r\n          let isCheck = this.cartList.filter(item=>item.selected)\r\n          if(isCheck.length===this.cartList.length) {\r\n            return true\r\n          }\r\n          return false\r\n        },\r\n        set(val) {\r\n          // console.log(val);\r\n          this.cartList.forEach(item=>{\r\n            item.selected=val\r\n          })\r\n      }\r\n    },\r\n    price() {\r\n      let num = 0\r\n      let checkGoods = this.cartList.filter(item=>item.selected)\r\n      checkGoods.forEach(item => {\r\n        num = num+item.price*item.count*100\r\n      })\r\n      return num\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.cartImages{\r\n  width: 88px;\r\n  height: 88px;\r\n}\r\n  .goods-card {\r\n    margin: 0;\r\n    background-color: white;\r\n  }\r\n\r\n  .delete-button {\r\n    height: 100%;\r\n  }\r\n  .van-swipe-cell{\r\n    margin: 5px 0;\r\n  }\r\n  .van-card__thumb {\r\n    width: 120px;\r\n  }\r\n  .van-submit-bar{\r\n    bottom: 50px;\r\n  }\r\n  .goodsList {\r\n    margin-bottom: 55px;\r\n  }\r\n  .custom-image .van-empty__image {\r\n    width: 90px;\r\n    height: 90px;\r\n  }\r\n  .bottom-button {\r\n    width: 160px;\r\n    height: 40px;\r\n  }\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=753088f1&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=753088f1&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"753088f1\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\r\n\r\n/**\r\n * 获取购物车\r\n */\r\nexport const getCart = () =>{\r\n    return request('/member/cart/mutli','get')\r\n}\r\n\r\n/**\r\n * 加入购物车\r\n */\r\nexport const addCart =(config) => {\r\n    return request('/member/cart','post',{...config})\r\n}\r\n\r\n/**\r\n * 删除购物车商品\r\n */\r\nexport const delCart = (config) =>{\r\n    return request('/member/cart','DELETE',{...config})\r\n}\r\n\r\n/**\r\n * 修改购物车商品\r\n */\r\nexport const updatCart = (config) =>{\r\n    return request(`/member/cart/${config.id}`,'put',{ selected:config.selected , count:config.count })\r\n}"],"names":["render","_vm","this","_c","_self","staticClass","attrs","cartList","length","_l","item","key","skuId","scopedSlots","_u","fn","on","$event","delCarts","proxy","count","price","name","attrsText","staticStyle","e","onCheckChange","model","value","selected","callback","$$v","$set","expression","picture","$router","push","id","onChange","noneToken","_e","_v","onSubmit","allCheck","staticRenderFns","data","checked","methods","map","dj","desc","goodsList","specs","ids","clearAll","clearInvalid","created","computed","get","set","checkGoods","num","component","getCart","request","addCart","config","delCart","updatCart"],"sourceRoot":""}